package ai.refact.engine.model;

/**
 * Enum representing categories of security vulnerabilities.
 * Based on OWASP Top 10 and CWE classifications.
 */
public enum VulnerabilityCategory {
    // OWASP Top 10 2021
    BROKEN_ACCESS_CONTROL("A01:2021", "Broken Access Control", "Restrictions on what authenticated users are allowed to do are often not properly enforced"),
    CRYPTOGRAPHIC_FAILURES("A02:2021", "Cryptographic Failures", "Failures related to cryptography which often leads to sensitive data exposure"),
    INJECTION("A03:2021", "Injection", "Application is vulnerable to injection attacks such as SQL, NoSQL, OS command injection"),
    INSECURE_DESIGN("A04:2021", "Insecure Design", "Risks related to design and architectural flaws"),
    SECURITY_MISCONFIGURATION("A05:2021", "Security Misconfiguration", "Missing appropriate security hardening or misconfigured permissions"),
    VULNERABLE_COMPONENTS("A06:2021", "Vulnerable and Outdated Components", "Using components with known vulnerabilities"),
    IDENTIFICATION_AUTHENTICATION("A07:2021", "Identification and Authentication Failures", "Confirmation of user's identity, authentication, and session management issues"),
    SOFTWARE_DATA_INTEGRITY("A08:2021", "Software and Data Integrity Failures", "Code and infrastructure that does not protect against integrity violations"),
    SECURITY_LOGGING("A09:2021", "Security Logging and Monitoring Failures", "Insufficient logging, detection, monitoring and active response"),
    SSRF("A10:2021", "Server-Side Request Forgery", "Application fetches a remote resource without validating user-supplied URL"),
    
    // Additional common categories
    XSS("CWE-79", "Cross-Site Scripting (XSS)", "Improper neutralization of input during web page generation"),
    PATH_TRAVERSAL("CWE-22", "Path Traversal", "Improper limitation of pathname to a restricted directory"),
    INSECURE_DESERIALIZATION("CWE-502", "Insecure Deserialization", "Deserialization of untrusted data"),
    SENSITIVE_DATA_EXPOSURE("OWASP", "Sensitive Data Exposure", "Exposure of sensitive information to unauthorized actors"),
    RACE_CONDITION("CWE-362", "Race Condition", "Concurrent execution using shared resource with improper synchronization"),
    BUSINESS_LOGIC("CUSTOM", "Business Logic Vulnerability", "Flaws in the application's business logic"),
    OTHER("GENERAL", "Other Security Issue", "Other security vulnerabilities not categorized above");
    
    private final String code;
    private final String displayName;
    private final String description;
    
    VulnerabilityCategory(String code, String displayName, String description) {
        this.code = code;
        this.displayName = displayName;
        this.description = description;
    }
    
    public String getCode() {
        return code;
    }
    
    public String getDisplayName() {
        return displayName;
    }
    
    public String getDescription() {
        return description;
    }
    
    /**
     * Check if this is an OWASP Top 10 category.
     */
    public boolean isOwaspTop10() {
        return code.startsWith("A");
    }
    
    /**
     * Check if this is a CWE category.
     */
    public boolean isCWE() {
        return code.startsWith("CWE-");
    }
}

