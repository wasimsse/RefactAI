package ai.refact.engine.model;

/**
 * Enum representing the severity levels of security vulnerabilities.
 * Based on CVSS (Common Vulnerability Scoring System) severity ratings.
 */
public enum VulnerabilitySeverity {
    CRITICAL(9.0, 10.0, "Critical vulnerabilities require immediate attention"),
    HIGH(7.0, 8.9, "High severity vulnerabilities should be addressed urgently"),
    MEDIUM(4.0, 6.9, "Medium severity vulnerabilities should be addressed in near term"),
    LOW(0.1, 3.9, "Low severity vulnerabilities should be addressed when convenient"),
    INFO(0.0, 0.0, "Informational findings with no direct security impact");
    
    private final double minScore;
    private final double maxScore;
    private final String description;
    
    VulnerabilitySeverity(double minScore, double maxScore, String description) {
        this.minScore = minScore;
        this.maxScore = maxScore;
        this.description = description;
    }
    
    public double getMinScore() {
        return minScore;
    }
    
    public double getMaxScore() {
        return maxScore;
    }
    
    public String getDescription() {
        return description;
    }
    
    /**
     * Get severity level from CVSS score.
     */
    public static VulnerabilitySeverity fromScore(double score) {
        if (score >= 9.0) return CRITICAL;
        if (score >= 7.0) return HIGH;
        if (score >= 4.0) return MEDIUM;
        if (score > 0.0) return LOW;
        return INFO;
    }
    
    /**
     * Get color code for UI display.
     */
    public String getColorCode() {
        return switch (this) {
            case CRITICAL -> "#DC2626"; // Red
            case HIGH -> "#EA580C"; // Orange
            case MEDIUM -> "#D97706"; // Amber
            case LOW -> "#16A34A"; // Green
            case INFO -> "#0284C7"; // Blue
        };
    }
}
