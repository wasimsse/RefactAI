package ai.refact.engine.model;

/**
 * Enumeration of security vulnerability types based on OWASP Top 10 and CWE standards.
 * 
 * Technology Stack:
 * - Java enum for type safety
 * - OWASP Top 10 2021 mapping
 * - CWE (Common Weakness Enumeration) integration
 */
public enum VulnerabilityType {
    
    // OWASP Top 10 2021 - A01: Broken Access Control
    BROKEN_ACCESS_CONTROL("Broken Access Control", "A01:2021"),
    
    // OWASP Top 10 2021 - A02: Cryptographic Failures
    WEAK_CRYPTOGRAPHY("Weak Cryptography", "A02:2021"),
    CRYPTOGRAPHIC_ISSUES("Cryptographic Issues", "A02:2021"),
    HARDCODED_SECRETS("Hardcoded Secrets", "A02:2021"),
    
    // OWASP Top 10 2021 - A03: Injection
    SQL_INJECTION("SQL Injection", "A03:2021"),
    XSS("Cross-Site Scripting (XSS)", "A03:2021"),
    LDAP_INJECTION("LDAP Injection", "A03:2021"),
    COMMAND_INJECTION("Command Injection", "A03:2021"),
    NO_SQL_INJECTION("NoSQL Injection", "A03:2021"),
    
    // OWASP Top 10 2021 - A04: Insecure Design
    INSECURE_DESIGN("Insecure Design", "A04:2021"),
    
    // OWASP Top 10 2021 - A05: Security Misconfiguration
    SECURITY_MISCONFIGURATION("Security Misconfiguration", "A05:2021"),
    
    // OWASP Top 10 2021 - A06: Vulnerable and Outdated Components
    KNOWN_VULNERABILITIES("Known Vulnerabilities", "A06:2021"),
    OUTDATED_DEPENDENCIES("Outdated Dependencies", "A06:2021"),
    
    // OWASP Top 10 2021 - A07: Identification and Authentication Failures
    BROKEN_AUTHENTICATION("Broken Authentication", "A07:2021"),
    WEAK_AUTHENTICATION("Weak Authentication", "A07:2021"),
    SESSION_MANAGEMENT("Session Management Issues", "A07:2021"),
    
    // OWASP Top 10 2021 - A08: Software and Data Integrity Failures
    INSECURE_DESERIALIZATION("Insecure Deserialization", "A08:2021"),
    DATA_INTEGRITY("Data Integrity Issues", "A08:2021"),
    
    // OWASP Top 10 2021 - A09: Security Logging and Monitoring Failures
    INSUFFICIENT_LOGGING("Insufficient Logging", "A09:2021"),
    INSUFFICIENT_MONITORING("Insufficient Monitoring", "A09:2021"),
    
    // OWASP Top 10 2021 - A10: Server-Side Request Forgery
    SSRF("Server-Side Request Forgery (SSRF)", "A10:2021"),
    
    // Additional common vulnerabilities
    CSRF("Cross-Site Request Forgery (CSRF)", "CWE-352"),
    XXE("XML External Entity (XXE)", "CWE-611"),
    PATH_TRAVERSAL("Path Traversal", "CWE-22"),
    FILE_UPLOAD("Insecure File Upload", "CWE-434"),
    RACE_CONDITION("Race Condition", "CWE-362"),
    BUFFER_OVERFLOW("Buffer Overflow", "CWE-120"),
    NULL_POINTER_DEREFERENCE("Null Pointer Dereference", "CWE-476"),
    RESOURCE_EXHAUSTION("Resource Exhaustion", "CWE-400"),
    INFORMATION_DISCLOSURE("Information Disclosure", "CWE-200"),
    
    // Additional types for ComprehensiveSecurityDetector
    CODE_QUALITY("Code Quality", "CWE-OTHER"),
    DEPENDENCY("Dependency Vulnerability", "A06:2021"),
    CONFIGURATION("Configuration Vulnerability", "A05:2021"),
    SECRETS_MANAGEMENT("Secrets Management", "A02:2021"),
    INJECTION("Injection", "A03:2021"),
    OTHER("Other", "CWE-OTHER");
    
    private final String displayName;
    private final String owaspCategory;
    
    VulnerabilityType(String displayName, String owaspCategory) {
        this.displayName = displayName;
        this.owaspCategory = owaspCategory;
    }
    
    public String getDisplayName() {
        return displayName;
    }
    
    public String getOwaspCategory() {
        return owaspCategory;
    }
    
    /**
     * Get CWE ID for this vulnerability type.
     */
    public String getCweId() {
        return switch (this) {
            case SQL_INJECTION -> "CWE-89";
            case XSS -> "CWE-79";
            case CSRF -> "CWE-352";
            case XXE -> "CWE-611";
            case PATH_TRAVERSAL -> "CWE-22";
            case FILE_UPLOAD -> "CWE-434";
            case RACE_CONDITION -> "CWE-362";
            case BUFFER_OVERFLOW -> "CWE-120";
            case NULL_POINTER_DEREFERENCE -> "CWE-476";
            case RESOURCE_EXHAUSTION -> "CWE-400";
            case INFORMATION_DISCLOSURE -> "CWE-200";
            case HARDCODED_SECRETS -> "CWE-798";
            case WEAK_CRYPTOGRAPHY -> "CWE-327";
            case INSECURE_DESERIALIZATION -> "CWE-502";
            case BROKEN_AUTHENTICATION -> "CWE-287";
            case BROKEN_ACCESS_CONTROL -> "CWE-284";
            case SECURITY_MISCONFIGURATION -> "CWE-16";
            case KNOWN_VULNERABILITIES -> "CWE-1104";
            case SSRF -> "CWE-918";
            default -> "CWE-OTHER";
        };
    }
    
    /**
     * Check if this vulnerability type is part of OWASP Top 10.
     */
    public boolean isOwaspTop10() {
        return owaspCategory.startsWith("A");
    }
    
    /**
     * Get the OWASP Top 10 rank for this vulnerability type.
     */
    public int getOwaspRank() {
        return switch (owaspCategory) {
            case "A01:2021" -> 1;
            case "A02:2021" -> 2;
            case "A03:2021" -> 3;
            case "A04:2021" -> 4;
            case "A05:2021" -> 5;
            case "A06:2021" -> 6;
            case "A07:2021" -> 7;
            case "A08:2021" -> 8;
            case "A09:2021" -> 9;
            case "A10:2021" -> 10;
            default -> 0;
        };
    }
}
